# -*- coding: utf-8 -*-
"""fifa_scarping

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1q_1awhITjPxR-UoVHLya0tBC8Fs9TrSD
"""

import json 
import requests 
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
import seaborn as sns
import pickle
import datetime as dt
from tqdm.notebook import tqdm
from IPython.display import Image

pd.set_option('max_columns', 100) # To see 50 columns
pd.set_option('max_rows', 100) # To see 100 rows

api = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJYLUFwcC1SYXRlLUxpbWl0IjoiNTAwOjEwIiwiYWNjb3VudF9pZCI6IjE1MTAyMjA3NzUiLCJhdXRoX2lkIjoiMiIsImV4cCI6MTY3NzQwMTAwNCwiaWF0IjoxNjYxODQ5MDA0LCJuYmYiOjE2NjE4NDkwMDQsInNlcnZpY2VfaWQiOiI0MzAwMTE0ODEiLCJ0b2tlbl90eXBlIjoiQWNjZXNzVG9rZW4ifQ.ngxIAncZ_jyxdeoYK12MPUkl_7SU7U7mEAyysZ7IC_k'

headers = {'Authorization': api}

total=[]
for i in tqdm(range(100000)):
    match = requests.get(f'https://api.nexon.co.kr/fifaonline4/v1.0/matches?matchtype=50&offset={i*100}&limit=100&orderby=desc',headers=headers)
    match=match.json()
    match=pd.DataFrame(match)
    total.append(match)

#range 값만 변경 하면 전체 데이터를 추출할 수 있을 것이다.
result=pd.concat(total, ignore_index=True)

result

match_url='https://api.nexon.co.kr/fifaonline4/v1.0/matches/{}'
match_urls=[]
for i in tqdm(result[0]): # total아니라 result[0]으로 하셔야해용
  match_urls.append(f'https://api.nexon.co.kr/fifaonline4/v1.0/matches/{i}'.format(i)) 


match_urls=pd.DataFrame(match_urls)
match_urls

r3 = []
for i in tqdm(match_urls[0]):
  r= requests.get(i,headers=headers) 
  r2=r.json()
  r3.append(r2)

r3=pd.DataFrame(r3)
r3

match_urls

